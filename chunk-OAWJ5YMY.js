import{a as N,b as X}from"./chunk-QJQ4CMW7.js";import{Aa as A,B as i,Ba as V,C as e,Ca as u,D as p,Da as U,Ea as q,Fa as z,G as v,Ga as $,H as d,Ha as G,I as g,Ia as L,Ja as R,K as o,Ka as B,L as C,La as H,M as x,Ma as J,N as S,Na as K,Oa as Q,Pa as W,Q as E,R as I,T as k,U as j,V as w,W as F,X as D,ca as T,e as M,j as P,p as f,q as b,t as O,u as l,v as _,w as y,x as h,z as m}from"./chunk-MWTJLIEH.js";function Z(s,t){if(s&1){let n=v();i(0,"div",7)(1,"button",56),d("click",function(){f(n);let a=g();return b(a.uploadProjectImages())}),o(2),e()()}if(s&2){let n=g();l(),m("disabled",n.isUploadingImages),l(),x(" ",n.isUploadingImages?"\u23F3 Subiendo im\xE1genes...":"\u{1F4E4} Subir Im\xE1genes Seleccionadas"," ")}}function ee(s,t){if(s&1){let n=v();i(0,"div",59),p(1,"img",60),i(2,"button",61),d("click",function(){let a=f(n).index,c=g(2);return b(c.removeProjectImage(a))}),o(3,"\u2715"),e()()}if(s&2){let n=t.$implicit,r=t.index;l(),m("src",n,O)("alt","Imagen "+(r+1))}}function te(s,t){if(s&1&&(i(0,"div",7)(1,"label"),o(2,"\u{1F4F8} Im\xE1genes en el Proyecto"),e(),i(3,"div",57),h(4,ee,4,2,"div",58),e()()),s&2){let n=g();l(4),m("ngForOf",n.projectImages)}}function ne(s,t){if(s&1){let n=v();i(0,"button",62),d("click",function(){f(n);let a=g();return b(a.cancelEdit())}),o(1," Cancelar "),e()}}function ie(s,t){if(s&1&&(i(0,"div",63),o(1),e()),s&2){let n=g();l(),x(" ",n.successMessage," ")}}function oe(s,t){if(s&1&&(i(0,"div",64),o(1),e()),s&2){let n=g();l(),x(" ",n.errorMessage," ")}}function re(s,t){if(s&1){let n=v();i(0,"div",65)(1,"h3"),o(2),e(),i(3,"p",66),o(4),e(),i(5,"p",67),o(6),e(),i(7,"p",68),o(8),e(),i(9,"div",69)(10,"button",70),d("click",function(){let a=f(n).$implicit,c=g();return b(c.onEdit(a))}),o(11,"Editar"),e(),i(12,"button",71),d("click",function(){let a=f(n).$implicit,c=g();return b(c.onDelete(a.id))}),o(13,"Eliminar"),e()()()}if(s&2){let n=t.$implicit;l(2),C(n.title),l(2),S("",n.engine," \u2022 ",n.year,""),l(),m("ngClass",n.status),l(),C(n.status),l(2),C(n.shortDescription)}}var Y=class s{constructor(t,n,r,a,c){this.fb=t;this.authService=n;this.firestoreService=r;this.storageService=a;this.router=c;this.initForm()}projectForm;projects$;isSubmitting=!1;successMessage=null;errorMessage=null;editingId=null;selectedCategories=[];imagesToUpload=[];projectImages=[];isUploadingImages=!1;ngOnInit(){this.projects$=this.firestoreService.getAll()}initForm(){this.projectForm=this.fb.group({title:["",u.required],engine:["",u.required],language:["",u.required],year:["",u.required],status:["",u.required],shortDescription:["",u.required],longDescription:["",u.required],video:[""],github:[""],itch:[""],demo:[""]})}onCategoryChange(t,n){t.target.checked?this.selectedCategories.includes(n)||this.selectedCategories.push(n):this.selectedCategories=this.selectedCategories.filter(a=>a!==n)}onTagsChange(t){let r=t.target.value.split(",").map(a=>a.trim()).filter(a=>a)}onImageFilesSelected(t){let n=t.target;n.files&&(this.imagesToUpload=Array.from(n.files))}uploadProjectImages(){return M(this,null,function*(){if(this.imagesToUpload.length===0){this.errorMessage="Selecciona im\xE1genes para subir";return}this.isUploadingImages=!0,this.errorMessage=null,this.successMessage=null;try{let t=this.editingId||"temp_"+Date.now();for(let r of this.imagesToUpload)try{let a=yield this.storageService.uploadAndGetURL(t,r,"images").toPromise();a&&this.projectImages.push(a)}catch(a){console.error("Error al subir imagen:",a),this.errorMessage="Error al subir algunas im\xE1genes"}this.imagesToUpload=[],this.successMessage=`\u2705 ${this.projectImages.length} imagen(es) cargada(s)`;let n=document.getElementById("imageUpload");n&&(n.value=""),setTimeout(()=>{this.successMessage=null},3e3)}finally{this.isUploadingImages=!1}})}removeProjectImage(t){this.projectImages.splice(t,1)}onSubmit(){if(this.projectForm.invalid||this.selectedCategories.length===0){this.errorMessage="Por favor completa todos los campos obligatorios y selecciona al menos una categor\xEDa";return}this.isSubmitting=!0,this.errorMessage=null,this.successMessage=null;let t=this.projectForm.value,n={title:t.title,engine:t.engine,language:t.language,year:t.year,category:this.selectedCategories,status:t.status,shortDescription:t.shortDescription,longDescription:t.longDescription,tags:[],images:this.projectImages,video:t.video||null,links:{github:t.github||null,itch:t.itch||null,demo:t.demo||null}};(this.editingId?this.firestoreService.update(this.editingId,n).pipe(P(()=>{})):this.firestoreService.create(n).pipe(P(()=>{}))).subscribe({next:()=>{this.isSubmitting=!1,this.successMessage=this.editingId?"Proyecto actualizado exitosamente":"Proyecto creado exitosamente",this.resetForm(),this.editingId=null,this.projects$=this.firestoreService.getAll(),setTimeout(()=>{this.successMessage=null},3e3)},error:a=>{this.isSubmitting=!1,this.errorMessage="Error al guardar el proyecto: "+a.message,console.error("Error:",a)}})}onEdit(t){this.editingId=t.id,this.selectedCategories=Array.isArray(t.category)?[...t.category]:[t.category],this.projectImages=t.images.map(r=>typeof r=="string"?r:r.url),this.projectForm.patchValue({title:t.title,engine:t.engine,language:t.language,year:t.year,status:t.status,shortDescription:t.shortDescription,longDescription:t.longDescription,video:t.video||"",github:t.links.github||"",itch:t.links.itch||"",demo:t.links.demo||""});let n=document.querySelector(".form-section");n&&n.scrollIntoView({behavior:"smooth",block:"start"})}onDelete(t){confirm("\xBFEst\xE1s seguro de que quieres eliminar este proyecto?")&&this.firestoreService.delete(t).subscribe({next:()=>{this.successMessage="Proyecto eliminado exitosamente",this.projects$=this.firestoreService.getAll(),setTimeout(()=>{this.successMessage=null},3e3)},error:n=>{this.errorMessage="Error al eliminar el proyecto: "+n.message}})}resetForm(){this.projectForm.reset(),this.selectedCategories=[],this.projectImages=[],this.imagesToUpload=[],this.editingId=null;let t=document.getElementById("imageUpload");t&&(t.value="")}cancelEdit(){this.resetForm()}logout(){this.authService.logout().subscribe({next:()=>{this.router.navigate(["/"])},error:t=>{console.error("Error al cerrar sesi\xF3n:",t)}})}static \u0275fac=function(n){return new(n||s)(_(K),_(A),_(N),_(X),_(T))};static \u0275cmp=y({type:s,selectors:[["app-admin-panel"]],decls:110,vars:13,consts:[[1,"admin-container"],[1,"admin-header"],[1,"btn-logout",3,"click"],[1,"admin-content"],[1,"form-section"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","title"],["type","text","id","title","formControlName","title","required",""],["for","engine"],["type","text","id","engine","formControlName","engine","required",""],["for","language"],["type","text","id","language","formControlName","language","required",""],["for","year"],["type","number","id","year","formControlName","year","required",""],[1,"checkbox-group"],[1,"checkbox-label"],["type","checkbox","value","proyecto",3,"change"],["type","checkbox","value","gamejam",3,"change"],["type","checkbox","value","vr",3,"change"],["for","status"],["id","status","formControlName","status","required",""],["value",""],["value","terminado"],["value","en-desarrollo"],["value","pausado"],["value","prototipo"],["for","shortDescription"],["id","shortDescription","formControlName","shortDescription","rows","2","required",""],["for","longDescription"],["id","longDescription","formControlName","longDescription","rows","4","required",""],["for","tags"],["type","text","id","tags","placeholder","tag1, tag2, tag3",3,"change"],[1,"form-group-nested"],["for","github"],["type","url","id","github","formControlName","github"],["for","itch"],["type","url","id","itch","formControlName","itch"],["for","demo"],["type","url","id","demo","formControlName","demo"],["for","imageUpload"],["type","file","id","imageUpload","multiple","","accept","image/*",3,"change"],[1,"text-muted"],["class","form-group",4,"ngIf"],["for","video"],["type","url","id","video","formControlName","video"],[1,"button-group"],["type","submit",1,"btn-submit",3,"disabled"],["type","button",1,"btn-reset",3,"click"],["type","button","class","btn-cancel",3,"click",4,"ngIf"],["class","success",4,"ngIf"],["class","error",4,"ngIf"],[1,"projects-section"],[1,"projects-list"],["class","project-card",4,"ngFor","ngForOf"],["type","button",1,"btn-upload-images",3,"click","disabled"],[1,"uploaded-images"],["class","image-item",4,"ngFor","ngForOf"],[1,"image-item"],[3,"src","alt"],["type","button",1,"btn-remove-image",3,"click"],["type","button",1,"btn-cancel",3,"click"],[1,"success"],[1,"error"],[1,"project-card"],[1,"meta"],[1,"status",3,"ngClass"],[1,"short-desc"],[1,"card-buttons"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click"]],template:function(n,r){n&1&&(i(0,"div",0)(1,"div",1)(2,"h1"),o(3,"Panel de Administraci\xF3n"),e(),i(4,"button",2),d("click",function(){return r.logout()}),o(5,"Cerrar Sesi\xF3n"),e()(),i(6,"div",3)(7,"div",4)(8,"h2"),o(9),e(),i(10,"form",5),d("ngSubmit",function(){return r.onSubmit()}),i(11,"div",6)(12,"div",7)(13,"label",8),o(14,"T\xEDtulo *"),e(),p(15,"input",9),e(),i(16,"div",7)(17,"label",10),o(18,"Motor *"),e(),p(19,"input",11),e()(),i(20,"div",6)(21,"div",7)(22,"label",12),o(23,"Lenguaje *"),e(),p(24,"input",13),e(),i(25,"div",7)(26,"label",14),o(27,"A\xF1o *"),e(),p(28,"input",15),e()(),i(29,"div",7)(30,"label"),o(31,"Categor\xEDas *"),e(),i(32,"div",16)(33,"label",17)(34,"input",18),d("change",function(c){return r.onCategoryChange(c,"proyecto")}),e(),o(35," Proyecto "),e(),i(36,"label",17)(37,"input",19),d("change",function(c){return r.onCategoryChange(c,"gamejam")}),e(),o(38," Game Jam "),e(),i(39,"label",17)(40,"input",20),d("change",function(c){return r.onCategoryChange(c,"vr")}),e(),o(41," VR "),e()()(),i(42,"div",7)(43,"label",21),o(44,"Estado *"),e(),i(45,"select",22)(46,"option",23),o(47,"Selecciona un estado"),e(),i(48,"option",24),o(49,"Terminado"),e(),i(50,"option",25),o(51,"En Desarrollo"),e(),i(52,"option",26),o(53,"Pausado"),e(),i(54,"option",27),o(55,"Prototipo"),e()()(),i(56,"div",7)(57,"label",28),o(58,"Descripci\xF3n Corta *"),e(),p(59,"textarea",29),e(),i(60,"div",7)(61,"label",30),o(62,"Descripci\xF3n Larga *"),e(),p(63,"textarea",31),e(),i(64,"div",7)(65,"label",32),o(66,"Tags (separados por comas)"),e(),i(67,"input",33),d("change",function(c){return r.onTagsChange(c)}),e()(),i(68,"div",7)(69,"label"),o(70,"Enlaces"),e(),i(71,"div",6)(72,"div",34)(73,"label",35),o(74,"GitHub"),e(),p(75,"input",36),e(),i(76,"div",34)(77,"label",37),o(78,"Itch.io"),e(),p(79,"input",38),e(),i(80,"div",34)(81,"label",39),o(82,"Demo"),e(),p(83,"input",40),e()()(),i(84,"div",7)(85,"label",41),o(86,"\u{1F5BC}\uFE0F Subir Im\xE1genes"),e(),i(87,"input",42),d("change",function(c){return r.onImageFilesSelected(c)}),e(),i(88,"small",43),o(89),e()(),h(90,Z,3,2,"div",44)(91,te,5,1,"div",44),i(92,"div",7)(93,"label",45),o(94,"URL del Video"),e(),p(95,"input",46),e(),i(96,"div",47)(97,"button",48),o(98),e(),i(99,"button",49),d("click",function(){return r.resetForm()}),o(100," Limpiar "),e(),h(101,ne,2,0,"button",50),e()(),h(102,ie,2,1,"div",51)(103,oe,2,1,"div",52),e(),i(104,"div",53)(105,"h2"),o(106,"Proyectos Existentes"),e(),i(107,"div",54),h(108,re,14,6,"div",55),E(109,"async"),e()()()()),n&2&&(l(9),C(r.editingId?"Editar Proyecto":"Agregar Nuevo Proyecto"),l(),m("formGroup",r.projectForm),l(79),x("",r.imagesToUpload.length," imagen(es) seleccionada(s)"),l(),m("ngIf",r.imagesToUpload.length>0),l(),m("ngIf",r.projectImages.length>0),l(6),m("disabled",r.projectForm.invalid||r.isSubmitting),l(),x(" ",r.isSubmitting?"Guardando...":r.editingId?"Actualizar":"Crear"," Proyecto "),l(3),m("ngIf",r.editingId),l(),m("ngIf",r.successMessage),l(),m("ngIf",r.errorMessage),l(5),m("ngForOf",I(109,11,r.projects$)))},dependencies:[D,k,j,w,F,Q,z,B,H,V,$,R,U,q,J,W,G,L],styles:[".admin-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:40px 20px}.admin-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:40px}.admin-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#333}.btn-logout[_ngcontent-%COMP%]{padding:10px 20px;background:#e74c3c;color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:500}.btn-logout[_ngcontent-%COMP%]:hover{background:#c0392b}.admin-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:40px}@media (max-width: 1024px){.admin-content[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-section[_ngcontent-%COMP%], .projects-section[_ngcontent-%COMP%]{background:#f9f9f9;padding:30px;border-radius:10px;border:1px solid #e0e0e0}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .projects-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;color:#333;margin-bottom:20px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:15px}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:8px;color:#333;font-weight:500;font-size:14px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:10px;border:1px solid #ddd;border-radius:5px;font-family:inherit;font-size:14px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 5px #667eea33}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.form-group-nested[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px;font-size:13px}.form-group-nested[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px;font-size:13px}.checkbox-group[_ngcontent-%COMP%]{display:flex;gap:15px}.checkbox-group[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer}.checkbox-group[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 20px;border:none;border-radius:5px;font-weight:600;cursor:pointer;transition:all .2s}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-submit[_ngcontent-%COMP%]{background:#667eea;color:#fff;flex:1}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){background:#5568d3}.btn-reset[_ngcontent-%COMP%]{background:#95a5a6;color:#fff}.btn-reset[_ngcontent-%COMP%]:hover{background:#7f8c8d}.btn-cancel[_ngcontent-%COMP%]{background:#f39c12;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background:#e67e22}.success[_ngcontent-%COMP%]{background:#d4edda;color:#155724;padding:12px;border-radius:5px;border-left:4px solid #28a745}.error[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:12px;border-radius:5px;border-left:4px solid #f5c6cb}.projects-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;max-height:800px;overflow-y:auto}.project-card[_ngcontent-%COMP%]{background:#fff;padding:15px;border-radius:5px;border:1px solid #ddd;transition:all .2s}.project-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.project-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#333;font-size:16px}.project-card[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{margin:5px 0;font-size:12px;color:#999}.project-card[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:3px;font-size:11px;font-weight:600;margin:8px 0}.project-card[_ngcontent-%COMP%]   .status.terminado[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.project-card[_ngcontent-%COMP%]   .status.en-desarrollo[_ngcontent-%COMP%]{background:#cce5ff;color:#004085}.project-card[_ngcontent-%COMP%]   .status.pausado[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.project-card[_ngcontent-%COMP%]   .status.prototipo[_ngcontent-%COMP%]{background:#e7d4f5;color:#5a1e7a}.project-card[_ngcontent-%COMP%]   .short-desc[_ngcontent-%COMP%]{margin:8px 0;font-size:13px;color:#666;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.card-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px}.card-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:6px;border:none;border-radius:3px;font-size:12px;cursor:pointer;font-weight:600;transition:all .2s}.btn-edit[_ngcontent-%COMP%]{background:#667eea;color:#fff}.btn-edit[_ngcontent-%COMP%]:hover{background:#5568d3}.btn-delete[_ngcontent-%COMP%]{background:#e74c3c;color:#fff}.btn-delete[_ngcontent-%COMP%]:hover{background:#c0392b}.btn-upload-images[_ngcontent-%COMP%]{background:#27ae60;color:#fff;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;font-weight:600;width:100%}.btn-upload-images[_ngcontent-%COMP%]:hover:not(:disabled){background:#229954}.btn-upload-images[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.uploaded-images[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:10px;margin-top:10px}.image-item[_ngcontent-%COMP%]{position:relative;border-radius:5px;overflow:hidden;border:2px solid #ddd;background:#f5f5f5}.image-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100px;object-fit:cover;display:block}.image-item[_ngcontent-%COMP%]:hover{border-color:#e74c3c}.image-item[_ngcontent-%COMP%]:hover   .btn-remove-image[_ngcontent-%COMP%]{opacity:1}.btn-remove-image[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;background:#e74c3c;color:#fff;border:none;border-radius:50%;width:25px;height:25px;cursor:pointer;font-weight:700;opacity:0;transition:opacity .2s;padding:0;display:flex;align-items:center;justify-content:center}.btn-remove-image[_ngcontent-%COMP%]:hover{background:#c0392b}"]})};export{Y as AdminPanelComponent};
